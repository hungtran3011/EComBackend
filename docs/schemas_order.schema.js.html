<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: schemas/order.schema.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: schemas/order.schema.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import mongoose from "mongoose";

/**
 * @name OrderItem
 * @author hungtran3011
 * @description Dữ liệu của một sản phẩm trong đơn hàng
 * @type {mongoose.Schema}
 * @property {mongoose.Schema.Types.ObjectId} product - Tham chiếu đến dữ liệu sản phẩm
 * @property {Number} quantity - Số lượng sản phẩm
 * @property {String} voucher - Mã giảm giá
 * @property {String} note - Ghi chú tuỳ chọn, sau này có thể set giới hạn ký tự
 * @property {Date} deliveryDate - Ngày giao hàng
 * @property {Number} unitPrice - Giá sản phẩm
 * @property {Number} deliveryFee - Phí giao hàng, việc triển khai tính toán cần thêm trình tự để thực hiện
 */
export const OrderItemSchema = mongoose.Schema({
  product: {type: mongoose.Schema.Types.ObjectId, ref: "Product", required: true},
  quantity: {type: Number, required: true},
  voucher: {type: String, required: false},
  note: {type: String, required: false},
  unitPrice: {type: Number, required: true},
  deliveryDate: {type: Date, required: true},
  deliveryFee: {type: Number, required: true},
}, {timestamps: true})

/**
 * @name OrderItemModel
 * @author hungtran3011
 * @type {mongoose.Model}
 * @description Model cho OrderItemSchema, cho phép thực hiện các thao tác CRUD trên OrderItem
 * @remarks Chúng ta cần OrderItemModel riêng biệt vì:
 * 1. Nó cho phép thực hiện các thao tác CRUD trực tiếp trên OrderItem (tìm kiếm, tạo mới, cập nhật)
 * 2. Có thể xác thực dữ liệu OrderItem độc lập với Order
 * 3. Cho phép tái sử dụng OrderItem trong các ngữ cảnh khác
 * 4. Giúp tổ chức mã nguồn rõ ràng, dễ bảo trì hơn
 */
export const OrderItemModel = mongoose.model("OrderItem", OrderItemSchema);

/**
 * @name OrderSchema
 * @author hungtran3011
 * @description Dữ liệu của một đơn hàng
 * @type {mongoose.Schema}
 * @property {Array&lt;OrderItem>} items - Danh sách sản phẩm trong đơn hàng
 * @property {mongoose.Schema.Types.ObjectId} user - Tham chiếu đến dữ liệu người dùng
 * @property {String} status - Trạng thái của đơn hàng
 * - `pending`: Chờ xử lý
 * - `processing`: Đang xử lý
 * - `shipped`: Đã giao hàng
 * - `delivered`: Đã nhận hàng
 * - `cancelled`: Đã hủy
 * @property {Object} shippingAddress - Địa chỉ giao hàng
 * @property {String} shippingAddress.home - Số nhà
 * @property {String} shippingAddress.street - Tên đường
 * @property {String} shippingAddress.city - Thành phố
 * @property {String} shippingAddress.state - Tiểu bang/Tỉnh (không bắt buộc)
 * @property {String} shippingAddress.zip - Mã bưu điện
 * @property {String} shippingAddress.country - Quốc gia
 * @property {Object} paymentDetails - Chi tiết thanh toán
 * @property {String} paymentDetails.method - Phương thức thanh toán
 * - `cash`: Thanh toán bằng tiền mặt
 * - `card`: Thanh toán bằng thẻ
 * - `paypal`: Thanh toán qua PayPal
 * - `stripe`: Thanh toán qua Stripe
 * - `momo`: Thanh toán qua MoMo
 * - `zalo`: Thanh toán qua ZaloPay
 * - `bank`: Thanh toán qua ngân hàng
 * @property {String} paymentDetails.transactionId - Mã giao dịch (không bắt buộc)
 * @property {Number} totalAmount - Tổng số tiền của đơn hàng, phải lớn hơn hoặc bằng 0
 */
export const OrderSchema = mongoose.Schema({  
  items: [OrderItemSchema],  
  user: { type: mongoose.Schema.Types.ObjectId, ref: 'User', required: true },  
  status: { 
    type: String, 
    required: true, 
    enum: ['pending', 'processing', 'shipped', 'delivered', 'cancelled'],
    default: 'pending' 
  },  
  shippingAddress: {  
    home: { type: String, required: true },
    street: { type: String, required: true },  
    city: { type: String, required: true },  
    state: { type: String, required: false },  
    zip: { type: String, required: true },  
    country: { type: String, required: true }  
  },  
  paymentDetails: {  
    method: { 
      type: String, 
      required: true,
      enum: [
        'cash', 
        'card', 
        'paypal', 
        'stripe', 
        'momo', 
        'zalo', 
        'bank'
      ] 
    },  
    transactionId: { type: String, required: false }  
  },  
  totalAmount: { type: Number, required: true, min: 0 },

}, {timestamps: true});  

/**
 * @name OrderModel
 * @type {mongoose.Model}
 * @description Model cho OrderSchema, cho phép thực hiện các thao tác CRUD trên Order
 */
export const OrderModel = mongoose.model('Order', OrderSchema);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#CategoriesValidationSchema">CategoriesValidationSchema</a></li><li><a href="global.html#CategoryModel">CategoryModel</a></li><li><a href="global.html#CategorySchema">CategorySchema</a></li><li><a href="global.html#CategoryValidationSchema">CategoryValidationSchema</a></li><li><a href="global.html#FieldDefinitionSchema">FieldDefinitionSchema</a></li><li><a href="global.html#IPRateLimiter">IPRateLimiter</a></li><li><a href="global.html#OrderItem">OrderItem</a></li><li><a href="global.html#OrderItemModel">OrderItemModel</a></li><li><a href="global.html#OrderModel">OrderModel</a></li><li><a href="global.html#OrderSchema">OrderSchema</a></li><li><a href="global.html#PaginationValidation">PaginationValidation</a></li><li><a href="global.html#ProductFieldValueSchema">ProductFieldValueSchema</a></li><li><a href="global.html#ProductListValidationSchema">ProductListValidationSchema</a></li><li><a href="global.html#ProductModel">ProductModel</a></li><li><a href="global.html#ProductSchema">ProductSchema</a></li><li><a href="global.html#StorageItemModel">StorageItemModel</a></li><li><a href="global.html#UserSchema">UserSchema</a></li><li><a href="global.html#addToCart">addToCart</a></li><li><a href="global.html#adminMiddleware">adminMiddleware</a></li><li><a href="global.html#adminSignIn">adminSignIn</a></li><li><a href="global.html#cancelOrder">cancelOrder</a></li><li><a href="global.html#completeOrder">completeOrder</a></li><li><a href="global.html#createCategory">createCategory</a></li><li><a href="global.html#createCategoryService">createCategoryService</a></li><li><a href="global.html#createNonRegisteredUser">createNonRegisteredUser</a></li><li><a href="global.html#createOrder">createOrder</a></li><li><a href="global.html#createProduct">createProduct</a></li><li><a href="global.html#createProductService">createProductService</a></li><li><a href="global.html#deleteCartItem">deleteCartItem</a></li><li><a href="global.html#deleteCategory">deleteCategory</a></li><li><a href="global.html#deleteCategoryService">deleteCategoryService</a></li><li><a href="global.html#deleteProduct">deleteProduct</a></li><li><a href="global.html#deleteProductService">deleteProductService</a></li><li><a href="global.html#deleteUser">deleteUser</a></li><li><a href="global.html#formatFieldValues">formatFieldValues</a></li><li><a href="global.html#generateOTP">generateOTP</a></li><li><a href="global.html#getAllCategories">getAllCategories</a></li><li><a href="global.html#getAllCategoriesService">getAllCategoriesService</a></li><li><a href="global.html#getAllOrders">getAllOrders</a></li><li><a href="global.html#getAllProducts">getAllProducts</a></li><li><a href="global.html#getAllProductsService">getAllProductsService</a></li><li><a href="global.html#getAllUserCart">getAllUserCart</a></li><li><a href="global.html#getAllUsers">getAllUsers</a></li><li><a href="global.html#getCategoryById">getCategoryById</a></li><li><a href="global.html#getCategoryByIdService">getCategoryByIdService</a></li><li><a href="global.html#getOrderById">getOrderById</a></li><li><a href="global.html#getProductById">getProductById</a></li><li><a href="global.html#getProductByIdService">getProductByIdService</a></li><li><a href="global.html#getUserById">getUserById</a></li><li><a href="global.html#handleLogout">handleLogout</a></li><li><a href="global.html#handleRefreshToken">handleRefreshToken</a></li><li><a href="global.html#isValidMongoId">isValidMongoId</a></li><li><a href="global.html#isValidObjectIdWithOptions">isValidObjectIdWithOptions</a></li><li><a href="global.html#isValidSchemaObjectId">isValidSchemaObjectId</a></li><li><a href="global.html#registerUser">registerUser</a></li><li><a href="global.html#router">router</a></li><li><a href="global.html#saveOTP">saveOTP</a></li><li><a href="global.html#sendOTPByEmail">sendOTPByEmail</a></li><li><a href="global.html#signIn">signIn</a></li><li><a href="global.html#swaggerDocs">swaggerDocs</a></li><li><a href="global.html#updateCartItemQuantity">updateCartItemQuantity</a></li><li><a href="global.html#updateCategory">updateCategory</a></li><li><a href="global.html#updateCategoryService">updateCategoryService</a></li><li><a href="global.html#updateOrder">updateOrder</a></li><li><a href="global.html#updateProduct">updateProduct</a></li><li><a href="global.html#updateProductService">updateProductService</a></li><li><a href="global.html#updateUser">updateUser</a></li><li><a href="global.html#uploadRateLimiter">uploadRateLimiter</a></li><li><a href="global.html#userMiddleware">userMiddleware</a></li><li><a href="global.html#validateFieldType">validateFieldType</a></li><li><a href="global.html#verifyOTP">verifyOTP</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Thu Mar 27 2025 08:36:07 GMT+0700 (Indochina Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
